/* Carpinoy Sticky Chat Widget v1.0 — Animated Brad */

/* ── Launcher (floating button) ─────────────── */
#cp-chat-launcher{
  position:fixed;right:18px;bottom:18px;z-index:9999;
  border:0;border-radius:999px;width:72px;height:72px;padding:0;
  cursor:pointer;background:transparent;display:grid;place-items:center;
  transition:transform .2s ease;
}
#cp-chat-launcher:hover{transform:scale(1.08)}
#cp-chat-launcher:active{transform:scale(.96)}

/* Pulsing ring around launcher */
#cp-chat-launcher::before{
  content:"";position:absolute;inset:-6px;border-radius:999px;
  background:rgba(197,205,39,.25);
  animation:cpPulse 2.6s ease-in-out infinite;
  pointer-events:none;
}
@keyframes cpPulse{
  0%,100%{transform:scale(1);opacity:.6}
  50%{transform:scale(1.18);opacity:0}
}

/* Brad SVG avatar inside launcher */
#cp-chat-launcher .cp-brad-avatar{
  width:64px;height:64px;border-radius:999px;
  box-shadow:0 4px 18px rgba(0,0,0,.22);
  overflow:hidden;position:relative;z-index:1;
}
#cp-chat-launcher .cp-brad-avatar svg{
  width:100%;height:100%;display:block;
}

/* Breathing animation on the SVG body */
@keyframes cpBreathe{
  0%,100%{transform:scaleY(1)}
  50%{transform:scaleY(1.015)}
}
#cp-chat-launcher .cp-brad-body{
  animation:cpBreathe 3.5s ease-in-out infinite;
  transform-origin:center bottom;
}

/* Blink animation */
@keyframes cpBlink{
  0%,92%,100%{transform:scaleY(1)}
  95%{transform:scaleY(0.08)}
}
#cp-chat-launcher .cp-brad-eyes{
  animation:cpBlink 4s ease-in-out infinite;
  transform-origin:center center;
}

/* Wave animation on hand */
@keyframes cpWave{
  0%,70%,100%{transform:rotate(0deg)}
  75%{transform:rotate(14deg)}
  80%{transform:rotate(-6deg)}
  85%{transform:rotate(10deg)}
  90%{transform:rotate(0deg)}
}
#cp-chat-launcher .cp-brad-hand{
  animation:cpWave 5s ease-in-out infinite;
  transform-origin:bottom center;
}

/* ── Hint bubble ────────────────────────────── */
#cp-chat-hint{
  position:fixed;right:100px;bottom:42px;z-index:9999;
  max-width:200px;
  background:linear-gradient(135deg,#1a2a1a,#2d4a2d);
  color:#fff;padding:10px 14px;border-radius:14px 14px 4px 14px;
  box-shadow:0 8px 24px rgba(0,0,0,.22);
  font-size:13px;font-weight:600;line-height:1.3;
  font-family:system-ui,-apple-system,sans-serif;
  opacity:0;transform:translateY(8px) scale(.95);
  transition:opacity .3s,transform .3s;pointer-events:none;
}
#cp-chat-hint.is-visible{
  opacity:1;transform:translateY(0) scale(1);pointer-events:auto;
}
#cp-chat-hint::after{
  content:"";position:absolute;right:-7px;bottom:16px;
  border:7px solid transparent;border-left-color:#2d4a2d;
}
#cp-chat-hint button{
  position:absolute;top:4px;right:6px;border:0;background:transparent;
  color:rgba(255,255,255,.7);cursor:pointer;font-size:14px;line-height:1;
}
@media(max-width:420px){#cp-chat-hint{right:96px;max-width:170px}}

/* ── Chat Panel ─────────────────────────────── */
#cp-chat-panel{
  position:fixed;right:18px;bottom:100px;
  width:min(370px,calc(100vw - 32px));
  height:min(520px,calc(100vh - 120px));
  z-index:9999;border-radius:20px;
  box-shadow:0 20px 50px rgba(0,0,0,.22),0 0 0 1px rgba(0,0,0,.06);
  background:#fff;overflow:hidden;
  display:none;flex-direction:column;
  font-family:system-ui,-apple-system,'Segoe UI',Roboto,sans-serif;
}
#cp-chat-panel.is-open{
  display:flex;
  animation:cpSlideUp .32s cubic-bezier(.16,1,.3,1) both;
}
@keyframes cpSlideUp{
  from{opacity:0;transform:translateY(30px) scale(.96)}
  to{opacity:1;transform:translateY(0) scale(1)}
}

/* ── Header ──────────────────────────────────── */
#cp-chat-header{
  display:flex;align-items:center;gap:10px;
  padding:12px 14px;flex-shrink:0;
  background:linear-gradient(135deg,#1a2a1a 0%,#2d4a2d 60%,#3a5a2a 100%);
  color:#fff;
}
#cp-chat-header .cp-header-avatar{
  width:38px;height:38px;border-radius:999px;overflow:hidden;flex-shrink:0;
  border:2px solid rgba(197,205,39,.4);
  box-shadow:0 2px 8px rgba(0,0,0,.2);
}
#cp-chat-header .cp-header-avatar svg{width:100%;height:100%;display:block}
#cp-chat-header-title{flex:1;min-width:0}
.cp-chat-title{font-weight:700;font-size:14px;letter-spacing:-.01em}
.cp-chat-subtitle{
  font-size:11px;font-weight:500;
  color:rgba(197,205,39,.85);
  display:flex;align-items:center;gap:5px;
}
.cp-chat-subtitle::before{
  content:"";width:6px;height:6px;border-radius:50%;
  background:#c5cd27;box-shadow:0 0 6px rgba(197,205,39,.5);flex-shrink:0;
}
#cp-chat-close{
  border:0;background:rgba(255,255,255,.1);color:#fff;
  width:30px;height:30px;border-radius:999px;cursor:pointer;
  font-size:16px;display:grid;place-items:center;
  transition:background .15s;flex-shrink:0;
}
#cp-chat-close:hover{background:rgba(255,255,255,.2)}

/* ── Message area ────────────────────────────── */
#cp-chat-body{
  flex:1;overflow-y:auto;padding:14px 12px 8px;
  background:linear-gradient(180deg,#fafbfc 0%,#f5f6f8 50%,#f0f1f3 100%);
}
#cp-chat-body::-webkit-scrollbar{width:4px}
#cp-chat-body::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:10px}
#cp-chat-body::-webkit-scrollbar-track{background:transparent}

#cp-chat-messages{display:flex;flex-direction:column;gap:8px}

.cp-chat-row{display:flex;width:100%}
.cp-chat-row--user{justify-content:flex-end}
.cp-chat-row--ai{justify-content:flex-start;gap:8px;align-items:flex-end}
.cp-chat-row--sys{justify-content:flex-start}

.cp-chat-msg{
  max-width:82%;padding:10px 14px;border-radius:16px;
  font-size:13.5px;line-height:1.5;white-space:pre-wrap;
  animation:cpFadeIn .25s ease-out both;
}
@keyframes cpFadeIn{
  from{opacity:0;transform:translateY(6px)}
  to{opacity:1;transform:translateY(0)}
}

.cp-chat-msg--user{
  background:linear-gradient(135deg,#c5cd27 0%,#a8b020 100%);
  color:#1a1a0a;border-radius:16px 4px 16px 16px;
  box-shadow:0 2px 8px rgba(197,205,39,.2);
}
.cp-chat-msg--ai{
  background:#f0f2f5;color:#1a1a2e;
  border-radius:4px 16px 16px 16px;
  box-shadow:0 1px 4px rgba(0,0,0,.06);
}
.cp-chat-msg--sys{
  background:rgba(0,0,0,.04);color:#555;
  border-radius:12px;font-size:12.5px;
  box-shadow:none;
}

/* Mini Brad avatar next to AI messages */
.cp-msg-avatar{
  width:28px;height:28px;border-radius:999px;overflow:hidden;flex-shrink:0;
  box-shadow:0 2px 6px rgba(0,0,0,.12);
}
.cp-msg-avatar svg{width:100%;height:100%;display:block}

/* Typing dots */
.cp-typing-dots{display:flex;gap:4px;padding:4px 0;align-items:center}
.cp-typing-dots span{
  width:7px;height:7px;border-radius:50%;background:#a0aab4;
  animation:cpDotBounce 1.2s ease-in-out infinite;
}
.cp-typing-dots span:nth-child(2){animation-delay:.15s}
.cp-typing-dots span:nth-child(3){animation-delay:.3s}
@keyframes cpDotBounce{
  0%,60%,100%{transform:translateY(0)}
  30%{transform:translateY(-5px)}
}

/* ── Footer ──────────────────────────────────── */
#cp-chat-footer{
  padding:10px 12px 12px;border-top:1px solid #e5e7eb;
  background:#fff;flex-shrink:0;
}
#cp-chat-footer .cp-input-row{
  display:flex;gap:8px;align-items:center;
}
.cp-chat-inp{
  flex:1;border:1.5px solid #e5e7eb;border-radius:22px;
  padding:9px 14px;font-size:13.5px;font-family:inherit;
  background:#f9fafb;color:#1a1a2e;outline:none;
  transition:border-color .2s,box-shadow .2s;
}
.cp-chat-inp:focus{
  border-color:#c5cd27;
  box-shadow:0 0 0 3px rgba(197,205,39,.15);
}
.cp-chat-inp::placeholder{color:#9ca3af}

.cp-chat-btn{
  border:0;border-radius:999px;
  width:38px;height:38px;
  background:linear-gradient(135deg,#c5cd27,#a8b020);
  color:#1a1a0a;font-size:16px;cursor:pointer;
  display:grid;place-items:center;flex-shrink:0;
  transition:transform .15s,background .15s;
}
.cp-chat-btn:hover{transform:scale(1.06)}
.cp-chat-btn:disabled{background:#e5e7eb;color:#9ca3af;cursor:default;transform:none}

.cp-chat-actions{
  display:flex;justify-content:center;padding-top:6px;
}
.cp-chat-link{
  background:transparent;border:0;
  color:#9ca3af;font-size:11px;cursor:pointer;
  text-decoration:underline;
}
.cp-chat-link:hover{color:#6b7280}

/* ── Lead form overrides ─────────────────────── */
.cp-lead-form{display:flex;flex-direction:column;gap:8px;padding:4px 0}
.cp-lead-form .cp-chat-inp{border-radius:12px}
.cp-lead-form .cp-lead-btn{
  border:0;border-radius:12px;padding:10px;
  background:linear-gradient(135deg,#c5cd27,#a8b020);
  color:#1a1a0a;font-weight:700;font-size:13px;
  cursor:pointer;transition:transform .15s;
}
.cp-lead-form .cp-lead-btn:hover{transform:scale(1.02)}
.cp-chat-notice{font-size:11.5px;color:#888;line-height:1.35;padding:0 2px 4px}
.cp-chat-error{color:#e53e3e;font-size:12px;display:none}

/* ── Footer credit ───────────────────────────── */
.cp-chat-credit{
  text-align:center;font-size:10px;color:#bbb;
  padding:4px 0 2px;
}
.cp-chat-credit b{color:#888}

/* ── Dark mode support ───────────────────────── */
html[data-theme="dark"] #cp-chat-panel{
  background:#111827;
  box-shadow:0 20px 50px rgba(0,0,0,.45),0 0 0 1px rgba(255,255,255,.08);
}
html[data-theme="dark"] #cp-chat-body{
  background:linear-gradient(180deg,#0f172a 0%,#111827 100%);
}
html[data-theme="dark"] .cp-chat-msg--ai{
  background:rgba(255,255,255,.08);color:#e5e7eb;
}
html[data-theme="dark"] .cp-chat-msg--user{
  background:linear-gradient(135deg,#c5cd27 0%,#a8b020 100%);color:#1a1a0a;
}
html[data-theme="dark"] .cp-chat-msg--sys{
  background:rgba(255,255,255,.05);color:#9ca3af;
}
html[data-theme="dark"] #cp-chat-footer{
  background:#111827;border-top-color:rgba(255,255,255,.1);
}
html[data-theme="dark"] .cp-chat-inp{
  background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.12);
  color:#e5e7eb;
}
html[data-theme="dark"] .cp-chat-inp::placeholder{color:rgba(255,255,255,.4)}
html[data-theme="dark"] .cp-chat-inp:focus{
  border-color:#c5cd27;
  box-shadow:0 0 0 3px rgba(197,205,39,.15);
}
html[data-theme="dark"] .cp-chat-credit{color:#555}
html[data-theme="dark"] .cp-chat-credit b{color:#777}
html[data-theme="dark"] .cp-chat-notice{color:#777}

/* ── Mobile adjustments ──────────────────────── */
@media(max-width:480px){
  #cp-chat-launcher{right:12px;bottom:12px;width:62px;height:62px}
  #cp-chat-launcher .cp-brad-avatar{width:56px;height:56px}
  #cp-chat-panel{right:8px;bottom:84px;width:calc(100vw - 16px);height:calc(100vh - 100px);border-radius:16px}
  #cp-chat-hint{right:82px;bottom:32px}
}
